<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Speak Name</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 2rem;
      text-align: center;
    }
    #status {
      font-size: 1.5rem;
      margin-bottom: 2rem;
    }
    #btnSpeak {
      font-size: 1.25rem;
      padding: 0.75rem 1.5rem;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div id="status">ğŸ”ˆ Loading voicesâ€¦</div>
  <button id="btnSpeak" disabled>â–¶ï¸ Speak Now</button>

  <script>
    // 1) Grab the "name" from URL: ?name=First%20Last
    const params = new URLSearchParams(window.location.search);
    const name = params.get("name") || "Unknown";

    // 2) Elements
    const statusEl = document.getElementById("status");
    const btn = document.getElementById("btnSpeak");

    // 3) Called when voices are loaded
    function voicesReady() {
      const voices = speechSynthesis.getVoices() || [];
      if (voices.length > 0) {
        // Show the loaded name and enable the button
        statusEl.textContent = "ğŸ”ˆ Ready to speak: " + name;
        btn.disabled = false;
      }
    }

    // 4) Listen for the browserâ€™s voiceschanged event
    speechSynthesis.onvoiceschanged = voicesReady;
    // ALSO try to load voices immediately (for some browsers)
    window.addEventListener("DOMContentLoaded", () => {
      voicesReady();
    });

    // 5) When the user clicks "Speak Now", fire TTS
    btn.addEventListener("click", () => {
      btn.disabled = true; // prevent doubleâ€tap
      statusEl.textContent = "ğŸ”ˆ Speaking: " + name;

      const utter = new SpeechSynthesisUtterance(name);

      // (Optionally) choose a specific voice, rate, or pitch:
      // const allVoices = speechSynthesis.getVoices();
      // utter.voice = allVoices.find(v => v.lang.startsWith("en")) || allVoices[0];
      // utter.rate = 1.0;
      // utter.pitch = 1.0;

      utter.onend = () => {
        statusEl.textContent = "ğŸ”ˆ Done speaking.";
      };
      speechSynthesis.speak(utter);
    });
  </script>
</body>
</html>
